#!/usr/bin/env python3
from pwn import *

# Enable debugging
context.arch = 'i386'
context.terminal = ['tmux', 'split-window', '-h']

def main():
    # Create pattern and send
    p = process('./rop1')
    pattern = cyclic(100)
    p.sendline(pattern)
    p.wait()
    
    # Find offset in pattern
    core = p.corefile
    eip_value = core.eip
    offset = cyclic_find(eip_value & 0xffffffff)
    print(f"EIP value: 0x{eip_value:x}")
    print(f"Offset: {offset}")

if __name__ == "__main__":
    main()
