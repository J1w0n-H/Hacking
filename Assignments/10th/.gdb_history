3
c
c
heap
r
c
c
3
c
heap
c
r
c
4
f
c
4
c
b *main+226
b *main+462
r
1
c
c
r
c
c
c
c
c
heap
x/5gx 405ac0
x/5gx 0x405ac0
x/s 0x405ac0
c
c
c
set disassembl-flavor intel
set disassembly-flavor intel
b main
b malloc
b free
r
r
r
c
p auth1
p auth2
x/32x 0x405ac0
c
r
c
p auth1
c
p auth1
x/32gx 0x405ac0
c
c
p auth2
x/32gx auth2
c
heap
x/32gx 0x405ac0
c
vmmap
heap
bins
p sizeof(struct auth)
r
1
c
1
c
heap
x/50gx 0x405ac0-16
p &auth1->callback
c
c
bins
heap-chunks
r
c
heap
x/50gx 0x405ac0-16
c
c
bins
heap-chunks
fastbins
r
set glibc 2.39
heap
x/50gx 0x405ac0
c
r
c
heap
x/32gx auth1
c
heap
x/32gx auth1
p auth1->callback
c
heap
x/32gx auth2
p auth2->callback
c
heap
r
c
c
heap
x/32gx auth2
c
heap
x/32gx auth2
p auth2->callback
heap
bins
vmmap
c
p &auth1->callback
x/gx auth1+0x48
heap-analysis-helper
c
c
heap
r
heap
c
c
r
c
r
c
1
c
r
c
heap
vmmap
x/32gx 0x405ac0
c
b main
b malloc
b free
b normal_function 
b root_shell 
r
p sizeof(struct auth)
c
heap
x/32gx auth1
p &auth1->callback
c
heap
bins
x/32gx auth1
c
r
c
heap
bins
x/32gx auth1
c
heap
bins
x/32gx auth1
x/gx auth1+0x48
p auth1->callback
b printf
r
c
heap
vmmap
c
p auth1
x/32gx auth1
p &auth1->callback
c
c
p auth2
x/32gx auth
x/32gx auth2
heap
c
heap
bins
x/32gc auth1
x/32gc auth2
heap
bins
x/32gx auth2
x/32gx auth1
c
heap
bins
x/32gx auth1
x/32gx auth2
c
heap
c
heap
c
heap
c
heap
bins
x/32gx auth1
x/32gx auth2
c
x/gx auth1+0x48
p auth1->callback
c
x/gx auth1+0x48
p auth1->callback
c
r
b printf
r
r
b printf
r
c
c
c
x/32gx
x/32gx auth1
ã…Š
c
c
bins
c
c
p &auth1->callback
x/gx auth1+0x48
x/gx auth1+0x48
c
p &auth1->callback
x/gx auth1+0x48
heap
b printf
r
c
2
c
c
c
bins
c
5
c
x/gx auth1+0x48
p auth1->callback
source heap_analysis.gdb 
r
